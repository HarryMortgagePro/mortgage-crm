// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Client {
  id             Int              @id @default(autoincrement())
  firstName      String
  lastName       String
  email          String?
  phone          String?
  tags           String?
  referralSource String?
  notes          String?
  applications   Application[]
  tasks          Task[]
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
}

model Application {
  id                 Int              @id @default(autoincrement())
  client             Client           @relation(fields: [clientId], references: [id])
  clientId           Int

  applicationType    String
  purpose            String
  status             String

  propertyAddress    String?
  propertyCity       String?
  propertyProvince   String?
  propertyType       String?

  purchasePrice      Float?
  mortgageAmount     Float?
  downPaymentAmount  Float?
  interestRate       Float?
  rateType           String?
  termYears          Int?
  amortizationYears  Int?

  lenderName         String?
  brokerFee          Float?
  lenderFee          Float?

  applicationDate    DateTime?
  conditionsDueDate  DateTime?
  closingDate        DateTime?
  fundedDate         DateTime?

  notes              String?

  tasks              Task[]
  documents          DocumentRecord[]

  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @updatedAt
}

model Task {
  id             Int         @id @default(autoincrement())
  title          String
  description    String?
  dueDate        DateTime?
  status         String
  priority       String?
  category       String?

  client         Client?     @relation(fields: [clientId], references: [id])
  clientId       Int?

  application    Application? @relation(fields: [applicationId], references: [id])
  applicationId  Int?

  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
}

model DocumentRecord {
  id             Int         @id @default(autoincrement())
  application    Application @relation(fields: [applicationId], references: [id])
  applicationId  Int
  docType        String
  status         String
  notes          String?

  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
}
